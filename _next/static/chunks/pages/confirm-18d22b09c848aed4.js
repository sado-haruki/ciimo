(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[161],{2061:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/confirm",function(){return t(6164)}])},8969:function(e,n,t){"use strict";var r=t(5893),a=t(8622),o=t.n(a);n.Z=function(e){e.topLink;return(0,r.jsx)("div",{className:o().header,children:(0,r.jsx)("span",{className:o().ciimo,children:"CIIMO"})})}},1764:function(e,n,t){"use strict";var r=t(5893),a=t(7294),o=t(2171),i=t.n(o);n.Z=function(e){var n=e.key,t=e.selectedSeat,o=e.reserved,c=e.clickSeat,l=e.seat,s=(0,a.useState)(!1),u=s[0],d=s[1];return(0,r.jsx)("button",{onClick:function(){c(l),d(!(t===l))},className:"".concat(u?i().selected:i().notSelected," \n                ").concat(o?i().disabled:i().abled),children:(0,r.jsx)("span",{className:i().number,children:l.seatName})},n)}},8418:function(e,n,t){"use strict";function r(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function a(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,o=[],i=!0,c=!1;try{for(t=t.call(e);!(i=(r=t.next()).done)&&(o.push(r.value),!n||o.length!==n);i=!0);}catch(l){c=!0,a=l}finally{try{i||null==t.return||t.return()}finally{if(c)throw a}}return o}}(e,n)||function(e,n){if(!e)return;if("string"===typeof e)return r(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return r(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}n.default=void 0;var o,i=(o=t(7294))&&o.__esModule?o:{default:o},c=t(6273),l=t(387),s=t(7190);var u={};function d(e,n,t,r){if(e&&c.isLocalURL(n)){e.prefetch(n,t,r).catch((function(e){0}));var a=r&&"undefined"!==typeof r.locale?r.locale:e&&e.locale;u[n+"%"+t+(a?"%"+a:"")]=!0}}var f=function(e){var n,t=!1!==e.prefetch,r=l.useRouter(),o=i.default.useMemo((function(){var n=a(c.resolveHref(r,e.href,!0),2),t=n[0],o=n[1];return{href:t,as:e.as?c.resolveHref(r,e.as):o||t}}),[r,e.href,e.as]),f=o.href,m=o.as,v=e.children,h=e.replace,p=e.shallow,_=e.scroll,b=e.locale;"string"===typeof v&&(v=i.default.createElement("a",null,v));var y=(n=i.default.Children.only(v))&&"object"===typeof n&&n.ref,j=a(s.useIntersection({rootMargin:"200px"}),2),x=j[0],N=j[1],I=i.default.useCallback((function(e){x(e),y&&("function"===typeof y?y(e):"object"===typeof y&&(y.current=e))}),[y,x]);i.default.useEffect((function(){var e=N&&t&&c.isLocalURL(f),n="undefined"!==typeof b?b:r&&r.locale,a=u[f+"%"+m+(n?"%"+n:"")];e&&!a&&d(r,f,m,{locale:n})}),[m,f,N,b,t,r]);var g={ref:I,onClick:function(e){n.props&&"function"===typeof n.props.onClick&&n.props.onClick(e),e.defaultPrevented||function(e,n,t,r,a,o,i,l){("A"!==e.currentTarget.nodeName||!function(e){var n=e.currentTarget.target;return n&&"_self"!==n||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||e.nativeEvent&&2===e.nativeEvent.which}(e)&&c.isLocalURL(t))&&(e.preventDefault(),null==i&&r.indexOf("#")>=0&&(i=!1),n[a?"replace":"push"](t,r,{shallow:o,locale:l,scroll:i}))}(e,r,f,m,h,p,_,b)},onMouseEnter:function(e){n.props&&"function"===typeof n.props.onMouseEnter&&n.props.onMouseEnter(e),c.isLocalURL(f)&&d(r,f,m,{priority:!0})}};if(e.passHref||"a"===n.type&&!("href"in n.props)){var w="undefined"!==typeof b?b:r&&r.locale,S=r&&r.isLocaleDomain&&c.getDomainLocale(m,w,r&&r.locales,r&&r.domainLocales);g.href=S||c.addBasePath(c.addLocale(m,w,r&&r.defaultLocale))}return i.default.cloneElement(n,g)};n.default=f},7190:function(e,n,t){"use strict";function r(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function a(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,o=[],i=!0,c=!1;try{for(t=t.call(e);!(i=(r=t.next()).done)&&(o.push(r.value),!n||o.length!==n);i=!0);}catch(l){c=!0,a=l}finally{try{i||null==t.return||t.return()}finally{if(c)throw a}}return o}}(e,n)||function(e,n){if(!e)return;if("string"===typeof e)return r(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return r(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}Object.defineProperty(n,"__esModule",{value:!0}),n.useIntersection=function(e){var n=e.rootRef,t=e.rootMargin,r=e.disabled||!c,s=o.useRef(),u=a(o.useState(!1),2),d=u[0],f=u[1],m=a(o.useState(n?n.current:null),2),v=m[0],h=m[1],p=o.useCallback((function(e){s.current&&(s.current(),s.current=void 0),r||d||e&&e.tagName&&(s.current=function(e,n,t){var r=function(e){var n=e.rootMargin||"",t=l.get(n);if(t)return t;var r=new Map,a=new IntersectionObserver((function(e){e.forEach((function(e){var n=r.get(e.target),t=e.isIntersecting||e.intersectionRatio>0;n&&t&&n(t)}))}),e);return l.set(n,t={id:n,observer:a,elements:r}),t}(t),a=r.id,o=r.observer,i=r.elements;return i.set(e,n),o.observe(e),function(){i.delete(e),o.unobserve(e),0===i.size&&(o.disconnect(),l.delete(a))}}(e,(function(e){return e&&f(e)}),{root:v,rootMargin:t}))}),[r,v,t,d]);return o.useEffect((function(){if(!c&&!d){var e=i.requestIdleCallback((function(){return f(!0)}));return function(){return i.cancelIdleCallback(e)}}}),[d]),o.useEffect((function(){n&&h(n.current)}),[n]),[p,d]};var o=t(7294),i=t(9311),c="undefined"!==typeof IntersectionObserver;var l=new Map},6164:function(e,n,t){"use strict";t.r(n);var r=t(5893),a=t(1163),o=t(7294),i=t(83),c=t.n(i),l=t(9669),s=t.n(l),u=t(8969),d=t(1664),f=t(1764);n.default=function(){var e=(0,a.useRouter)(),n=(0,o.useState)({}),t=n[0],i=n[1],l=(0,o.useState)({}),m=l[0],v=l[1],h=(0,o.useState)(!1),p=h[0],_=h[1],b=(0,o.useRef)([]),y=(0,o.useRef)(),j=(0,o.useState)(!1),x=j[0],N=j[1],I=(0,o.useCallback)((function(){var e=S(localStorage.getItem("reservation"));s().get("http://localhost:5000/theater/").then((function(n){var t,r,a,o=n.data;b.current=(null===(a=null===(r=null===(t=o.find((function(n){return n.id===e.theaterId})))||void 0===t?void 0:t.film.find((function(n){return n.id===e.filmId})))||void 0===r?void 0:r.schedule.find((function(n){return n.id===e.scheduleId})))||void 0===a?void 0:a.seat)||[],console.log(b),N(!0)}))}),[]);(0,o.useEffect)((function(){i(g(localStorage.getItem("reservation"))),v(g(localStorage.getItem("reservationSeat"))),I()}),[I]);var g=function(e){return null!==e?JSON.parse(e):""},w=function(e){return e.film.find((function(e){return e.id===t.filmId})).schedule.find((function(e){return e.id===t.scheduleId})).seat.find((function(e){return e.row===m.row})).column.find((function(e){return e.seatName===m.seatName})).reserved=!0,e},S=function(e){return e?JSON.parse(e):null},k=function(e){var n={row:e.row,seatName:e.seatName};y.current=n};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.Z,{}),(0,r.jsx)("div",{className:c().container,children:(0,r.jsxs)("main",{className:c().main,children:[(0,r.jsx)("div",{className:c().items,children:(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:c().label,children:"\u6620\u753b\u9928"}),(0,r.jsx)("span",{className:c().item,children:t.theaterName})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:c().label,children:"\u4f5c\u54c1"}),(0,r.jsx)("span",{className:c().item,children:t.filmName})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:c().label,children:"\u4e0a\u6620\u65e5\u6642"}),(0,r.jsx)("span",{className:c().item,children:t.schedule})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:c().label,children:"\u5ea7\u5e2d"}),(0,r.jsxs)("span",{className:c().item,children:[m.row,"-",m.seatName]})]})]})}),(0,r.jsxs)("div",{className:c().buttons,children:[(0,r.jsx)("button",{onClick:function(){return e.push("../seatSelect")},className:c().back,children:"\u623b\u308b"}),(0,r.jsx)("button",{onClick:function(){s().get("http://localhost:5000/theater/".concat(t.theaterId)).then((function(n){var r,a,o,i=w(n.data),c=null===(r=i.film.find((function(e){return e.id===t.filmId})))||void 0===r?void 0:r.schedule.find((function(e){return e.id===t.scheduleId}));if(null===(o=null===(a=null===c||void 0===c?void 0:c.seat.find((function(e){return e.row===m.row})))||void 0===a?void 0:a.column.find((function(e){return e.seatName===m.seatName})))||void 0===o?void 0:o.reserved)return b.current=c.seat,void _(!0);s().put("http://localhost:5000/theater/".concat(t.theaterId),{id:i.id,name:i.name,film:i.film}),e.push({pathname:"../complete",query:{paymentCode:"ABC".concat(t.theaterId).concat(t.filmId).concat(t.scheduleId).concat(m.row).concat(m.seatName)}})})).catch((function(n){s().get("https://my-json-server.typicode.com/sado-haruki/dbjson/theater/".concat(t.theaterId)).then((function(n){if(!function(e){var n,r,a,o;return null===(o=null===(a=null===(r=null===(n=e.film.find((function(e){return e.id===t.filmId})))||void 0===n?void 0:n.schedule.find((function(e){return e.id===t.scheduleId})))||void 0===r?void 0:r.seat.find((function(e){return e.row===m.row})))||void 0===a?void 0:a.column.find((function(e){return e.seatName===m.seatName})))||void 0===o?void 0:o.reserved}(n.data)){var r=w(n.data);s().put("https://my-json-server.typicode.com/sado-haruki/dbjson/theater/".concat(t.theaterId),{id:r.id,name:r.name,film:r.film}),e.push({pathname:"../complete",query:{paymentCode:"ABC".concat(t.theaterId).concat(t.filmId).concat(t.scheduleId).concat(m.row).concat(m.seatName)}})}}))}))},className:c().complete,children:"\u4e88\u7d04\u3092\u78ba\u5b9a\u3059\u308b"})]}),p?(0,r.jsx)("div",{className:c().overlay,children:(0,r.jsx)("div",{className:c().modalField,children:(0,r.jsxs)("div",{className:c().contants,children:[(0,r.jsxs)("div",{className:c().captions,children:[(0,r.jsx)("span",{className:c().erorrIcon,children:"!"}),(0,r.jsx)("span",{className:c().erorrText,children:"\u9078\u629e\u3055\u308c\u305f\u5e2d\u306f\u65e2\u306b\u4e88\u7d04\u3055\u308c\u3066\u3044\u307e\u3059"}),(0,r.jsx)("div",{children:"\u5ea7\u5e2d\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044"})]}),(0,r.jsx)("div",{className:c().selectField,children:x?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:c().screen,children:"SCREEN"}),b.current.map((function(e,n){return(0,r.jsxs)("div",{className:c().seats,children:[(0,r.jsx)("span",{className:c().row,children:e.row}),e.column.map((function(n,t){return(0,r.jsx)(f.Z,{selectedSeat:y.current||{},reserved:n.reserved,clickSeat:k,seat:{row:e.row,seatName:n.seatName}},t)})),(0,r.jsx)("div",{className:c().row,children:e.row},n)]},n)}))]}):(0,r.jsx)(r.Fragment,{children:"\u8aad\u307f\u8fbc\u307f\u4e2d"})}),(0,r.jsxs)("div",{className:c().buttons,children:[(0,r.jsx)(d.default,{href:"/seatSelect",children:(0,r.jsx)("a",{children:(0,r.jsx)("button",{className:c().back,children:"\u5ea7\u5e2d\u9078\u629e\u753b\u9762\u306b\u623b\u308b"})})}),(0,r.jsx)(d.default,{href:"/confirm",children:(0,r.jsx)("a",{onClick:function(e){var n,t;e.stopPropagation(),I(),(null===(t=null===(n=b.current.find((function(e){var n;return e.row===(null===(n=y.current)||void 0===n?void 0:n.row)})))||void 0===n?void 0:n.column.find((function(e){var n;return e.seatName===(null===(n=y.current)||void 0===n?void 0:n.seatName)})))||void 0===t?void 0:t.reserved)?e.preventDefault():(localStorage.setItem("reservationSeat",JSON.stringify(y.current)),_(!1),v(g(localStorage.getItem("reservationSeat"))))},children:(0,r.jsx)("button",{className:c().confirm,children:"\u6c7a\u5b9a\u3059\u308b"})})})]})]})})}):(0,r.jsx)("div",{children:" "})]})})]})}},8622:function(e){e.exports={header:"Header_header__Kpax6",ciimo:"Header_ciimo__2WVAt"}},2171:function(e){e.exports={abled:"seatButton_abled__wB55g",disabled:"seatButton_disabled__VEF_0",selected:"seatButton_selected__0yf7L",number:"seatButton_number__qS9ff"}},83:function(e){e.exports={container:"confirm_container__nTVmj",main:"confirm_main__F8Pch",items:"confirm_items__jcbI4",label:"confirm_label__GJToG",item:"confirm_item__dIl6O",buttons:"confirm_buttons__U8QV6",back:"confirm_back__rPAQK",complete:"confirm_complete__vGs10",overlay:"confirm_overlay__tQk0z",modalField:"confirm_modalField__wmICL",contants:"confirm_contants__GRil_",captions:"confirm_captions__kzAKx",erorrIcon:"confirm_erorrIcon__VHxHA",erorrText:"confirm_erorrText__CkjHb",selectField:"confirm_selectField__noRut",screen:"confirm_screen__uVLfz",seats:"confirm_seats__Ydo0X",row:"confirm_row__Dz6kW",confirm:"confirm_confirm___UINI"}},1664:function(e,n,t){e.exports=t(8418)},1163:function(e,n,t){e.exports=t(387)}},function(e){e.O(0,[669,774,888,179],(function(){return n=2061,e(e.s=n);var n}));var n=e.O();_N_E=n}]);