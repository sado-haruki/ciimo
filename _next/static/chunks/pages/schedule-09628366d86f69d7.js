(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{3229:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/schedule",function(){return t(3705)}])},8969:function(e,n,t){"use strict";var a=t(5893),r=t(8622),c=t.n(r);n.Z=function(e){e.topLink;return(0,a.jsx)("div",{className:c().header,children:(0,a.jsx)("span",{className:c().ciimo,children:"CIIMO"})})}},3705:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return _}});var a=t(5893),r=t(9669),c=t.n(r),s=t(7294),i=t(8969),u=t(2422),d=t.n(u),o=t(1163),l=t(834),m=t.n(l),f=[],h=function(e){var n=e.theaters;f=[],n.forEach((function(e){e.film.forEach((function(n){0!==f.length&&f.some((function(e){return e.filmName===n.name}))||f.push({filmId:n.id,filmName:n.name,theaters:[]}),f.forEach((function(t){t.filmName===n.name&&t.theaters.push({id:e.id,name:e.name,schedule:n.schedule})}))}))}));return(0,a.jsx)(a.Fragment,{children:f.map((function(e){return(0,a.jsxs)("div",{className:m().theater,children:[e.filmName,(0,a.jsx)("div",{}),e.theaters.map((function(n){return(0,a.jsxs)("div",{className:m().film,children:[n.name,(0,a.jsx)("div",{}),n.schedule.map((function(t){return function(e){var n=[];return e.seat.forEach((function(e){n.push(e.column.some((function(e){return 0==e.reserved})))})),!n.some((function(e){return 1==e}))}(t)?(0,a.jsxs)("button",{className:m().disabled,children:["".concat(t.startTime,"~").concat(t.endTime),(0,a.jsx)("div",{children:"\u6e80\u5e2d"})]},t.id):(0,a.jsxs)("button",{className:m().schedule,onClick:function(){return function(e,n,t){var a={theaterId:e.id,theaterName:e.name,filmId:n.filmId,filmName:n.filmName,scheduleId:t.id,schedule:t.date+" "+t.startTime+"~"+t.endTime};localStorage.setItem("reservation",JSON.stringify(a)),o.default.push("../seatSelect")}(n,e,t)},children:["".concat(t.startTime,"~").concat(t.endTime),(0,a.jsx)("div",{children:"\u4e88\u7d04\u8cfc\u5165"})]},t.id)}))]},n.name)}))]},e.filmName)}))})},_=function(){var e=(0,s.useRef)(),n=(0,s.useState)(),t=n[0],r=n[1],u=(0,s.useState)("2/7(\u6708)"),l=u[0],m=u[1],f=(0,o.useRouter)(),_=(0,s.useCallback)((function(){var n={filmName:"string"===typeof f.query.filmName?f.query.filmName:"",zoneId:Number(f.query.zoneId),areaId:Number(f.query.areaId),frontFree:"true"===f.query.frontFree,sideFree:"true"===f.query.sideFree},t=[];return e.current&&(0==n.areaId?e.current:e.current.filter((function(e){return e.areaId===n.areaId}))).forEach((function(e){var a=[];e.film.forEach((function(e){var t=[];n.filmName&&-1===e.name.indexOf(n.filmName)||(e.schedule.forEach((function(e){if(e.date===l){var a=!0;n.frontFree&&(a=!1,e.seat.forEach((function(t){var r=t.row.charCodeAt(0)-"A".charCodeAt(0);t.column.map((function(t){t.reserved||0!==n.zoneId&&t.zoneId!==n.zoneId||0!==r&&e.seat[r-1].column[Number(t.seatName)-1].reserved||(a=!0)}))})));var r=!0;if(n.sideFree&&(r=!1,e.seat.forEach((function(t){var a=t.row.charCodeAt(0)-"A".charCodeAt(0);t.column.map((function(t){t.reserved||0!==n.zoneId&&t.zoneId!==n.zoneId||"1"!==t.seatName&&e.seat[a].column[Number(t.seatName)-2].reserved||"6"!==t.seatName&&e.seat[a].column[Number(t.seatName)].reserved||(r=!0)}))}))),0!==n.zoneId){var c=[];e.seat.forEach((function(e){var t=e.column.filter((function(e){return e.zoneId===n.zoneId}));0!==t.length&&c.push(t.every((function(e){return e.reserved})))})),c.some((function(e){return!e}))&&a&&r&&t.push(e)}else{a&&r&&t.push(e);e.seat.forEach((function(e){e.column.filter((function(e){return e.zoneId===n.zoneId})).every((function(e){return e.reserved}))&&!0}))}}})),0!==t.length&&a.push({id:e.id,name:e.name,schedule:t}))})),0!==a.length&&t.push({id:e.id,name:e.name,areaId:e.areaId,film:a})})),t}),[f.query.areaId,f.query.frontFree,f.query.sideFree,f.query.zoneId,l]);return(0,s.useEffect)((function(){return r(_())}),[l,_]),(0,s.useEffect)((function(){c().get("http://localhost:5000/theater",{timeout:500}).then((function(n){e.current=n.data,r(_())})).catch((function(n){c().get("https://my-json-server.typicode.com/sado-haruki/dbjson/theater").then((function(n){e.current=n.data,r(_())}))}))}),[]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.Z,{}),(0,a.jsxs)("div",{className:d().main,children:[(0,a.jsx)("div",{className:d().back,onClick:function(){history.back()},children:"\u25c0\ufe0e\u691c\u7d22\u6761\u4ef6\u306b\u623b\u308b"}),(0,a.jsx)("div",{className:d().title,children:"\u691c\u7d22\u7d50\u679c"}),(0,a.jsxs)("div",{className:d().contants,children:[(0,a.jsxs)("div",{className:d().dateTabs,children:[(0,a.jsx)("button",{className:"2/7(\u6708)"==l?d().selected:d().dateTab,onClick:function(){return m("2/7(\u6708)")},children:"2/7(\u6708)"}),(0,a.jsx)("button",{className:"2/8(\u706b)"==l?d().selected:d().dateTab,onClick:function(){return m("2/8(\u706b)")},children:"2/8(\u706b)"}),(0,a.jsx)("button",{className:"2/9(\u6c34)"==l?d().selected:d().dateTab,onClick:function(){return m("2/9(\u6c34)")},children:"2/9(\u6c34)"}),(0,a.jsx)("button",{className:"2/10(\u6728)"==l?d().selected:d().dateTab,onClick:function(){return m("2/10(\u6728)")},children:"2/10(\u6728)"}),(0,a.jsx)("button",{className:"2/11(\u91d1)"==l?d().selected:d().dateTab,onClick:function(){return m("2/11(\u91d1)")},children:"2/11(\u91d1)"}),(0,a.jsx)("button",{className:"2/12(\u571f)"==l?d().selected:d().dateTab,onClick:function(){return m("2/12(\u571f)")},children:"2/12(\u571f)"}),(0,a.jsx)("button",{className:"2/13(\u65e5)"==l?d().selected:d().dateTab,onClick:function(){return m("2/13(\u65e5)")},children:"2/13(\u65e5)"})]}),t?(0,a.jsx)(h,{theaters:t}):(0,a.jsx)("div",{children:" "})]})]})]})}},8622:function(e){e.exports={header:"Header_header__Kpax6",ciimo:"Header_ciimo__2WVAt"}},2422:function(e){e.exports={main:"schedule_main__pnOSX",back:"schedule_back__6YeEV",title:"schedule_title__MB1Uq",contants:"schedule_contants__zWJpW",dateTabs:"schedule_dateTabs__DOqaI",dateTab:"schedule_dateTab__1Wvjc",selected:"schedule_selected__Vt2sc"}},834:function(e){e.exports={theater:"schedule_theater___luHR",film:"schedule_film__JvwHl",schedule:"schedule_schedule__XKaAF",disabled:"schedule_disabled__WFYl7"}},1163:function(e,n,t){e.exports=t(387)}},function(e){e.O(0,[669,774,888,179],(function(){return n=3229,e(e.s=n);var n}));var n=e.O();_N_E=n}]);